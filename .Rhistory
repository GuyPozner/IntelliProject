(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]))
sum(a)
animalWindowNosepokesCount$TimeError[i] <-
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]) &
(windowNosepokes$TimeError == 1))
i <- 2
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]) &
(windowNosepokes$TimeError == 1))
i <- 1
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]) &
(windowNosepokes$TimeError == 1))
windowNosepokes$TimeError
knit2html("TrainingLog20160401.Rmd")
rm(list = ls())
```{r, echo = FALSE}
#Read the intellicage data, nosepokes, visits, and animals and attach the two consecutive days
sessionPath <- "Sessions/2016-04-03 17.16.27/"
sessionPath2 <- "Sessions/2016-04-04 11.11.49/"
visits <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
visits2 <- read.csv(paste0(sessionPath2,"IntelliCage/Visits.txt"), sep = "\t")
visits2$VisitID <- length(visits$VisitID) + visits2$VisitID
nosepokes <- read.csv(paste0(sessionPath,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes2 <- read.csv(paste0(sessionPath2,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes2$VisitID <- length(visits$VisitID) + nosepokes2$VisitID
visits <- rbind(visits, visits2)
nosepokes <- rbind(nosepokes, nosepokes2)
#remove the nosepokes from the right side
nosepokes <- nosepokes[!nosepokes$SideError,]
#Keep only the first nosepoke in each visit
nosepokes <- nosepokes[!duplicated(nosepokes$VisitID),]
animals <- read.csv(paste0(sessionPath,"/Animals.txt"), sep = "\t")
View(nosepokes2)
View(nosepokes)
View(nosepokes)
View(visits)
knit2html("TrainingLog20160401-2.Rmd")
rm(list = ls())
knit2html("TrainingLog20160401-2.Rmd")
View(visits3)
View(visits2)
View(visits)
class(visits$Start)
class(visits2$Start)
class(visits3$Start)
rm(list = ls())
sessionPath <- "Sessions/2016-04-03 17.16.27/"
sessionPath2 <- "Sessions/2016-04-04 11.11.49/"
visits <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
class(visits$Start)
visits <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
class(visits$Start)
visits2$VisitID <- length(visits$VisitID) + visits2$VisitID
visits2 <- read.csv(paste0(sessionPath2,"IntelliCage/Visits.txt"), sep = "\t")
class(visits2$Start)
head(visits)
head(visits2)
tail(visits)
tail(visits2)
visits2$VisitID <- length(visits$VisitID) + visits2$VisitID
visits2$VisitID[1]
class(visits2$Start)
class(visits$Start)
visits3 <- rbind(visits, visits2)
class(visits3$Start)
rm(list = ls())
sessionPath <- "Sessions/2016-04-03 17.16.27/"
sessionPath2 <- "Sessions/2016-04-04 11.11.49/"
visits <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
visits2 <- read.csv(paste0(sessionPath2,"IntelliCage/Visits.txt"), sep = "\t")
visits2$VisitID <- length(visits$VisitID) + visits2$VisitID
nosepokes <- read.csv(paste0(sessionPath,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes2 <- read.csv(paste0(sessionPath2,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes2$VisitID <- length(visits$VisitID) + nosepokes2$VisitID
visits3 <- rbind(visits, visits2)
nosepokes3 <- rbind(nosepokes, nosepokes2)
#remove the nosepokes from the right side
nosepokes <- nosepokes[!nosepokes$SideError,]
#Keep only the first nosepoke in each visit
nosepokes <- nosepokes[!duplicated(nosepokes$VisitID),]
animals <- read.csv(paste0(sessionPath,"/Animals.txt"), sep = "\t")
```
and assigns animal name for each event as a factor(visit and nosepoke).
```{r, echo = FALSE}
#Replace AnimalTag with its AnimalName
visits$AnimalName <- lapply(visits$AnimalTag,
function(x){
animals$AnimalName[animals$AnimalTag == x ]})
visits <- transform(visits, AnimalName = unlist(AnimalName))
#Assigning an animal name to each visit id in the nosepokes data set
nosepokes$AnimalName <- lapply(nosepokes$VisitID,
function(x){
visits$AnimalName[visits$VisitID
== x ]})
nosepokes <- transform(nosepokes, AnimalName = unlist(AnimalName))
```
This is the visit count with the appropriate plot
```{r, echo = FALSE}
#Plots visit count per animal
visitsCountPlot <- ggplot(visits, aes(AnimalName)) +
geom_bar() +
xlab("") +
ggtitle("visits Count")
print(table(visits$AnimalName))
plot(visitsCountPlot)
```
Visits over time for each animal
```{r, fig.width=10, fig.height=4, echo = FALSE}
#plot visits over time using the ggplot2 package
visitPoints <- geom_point(aes(x = as.POSIXct(visits$Start),
y = visits$AnimalName,
colour = visits$AnimalName),
alpha = 0.3)
visitPointsPlot <- ggplot() +
visitPoints +
xlab("") +
ylab("") +
ggtitle("Visits") +
theme(legend.title=element_blank())
plot(visitPointsPlot)
```
Visit count across absoulute time
```{r, echo = FALSE}
#Count visits per hour for each animal
animalDat <- split(visits, visits$AnimalName)
visitHourAnimal <- sapply(animalDat,
function(x){vapply(split(1:nrow(x),
format(as.POSIXlt(x$Start),
"%Y-%m-%d%H:00:00",
tz='UTC')),
length,
0)},
simplify = "array")
visitHourAnimal <- unlist(visitHourAnimal)
visitHourAnimalDF <- read.table(text = names(visitHourAnimal), sep = ".")
visitHourAnimalDF$VisitCount <- as.numeric(visitHourAnimal)
names(visitHourAnimalDF) <- c("AnimalName", "Hour", "VisitCount")
visitHourAnimalDF$Hour <- as.POSIXct(visitHourAnimalDF$Hour)
```
```{r, echo = FALSE, fig.width = 12, fig.height = 6}
visitLines <- ggplot(visitHourAnimalDF,
aes(Hour, VisitCount, colour = AnimalName))
visitCountPlot <- visitLines + geom_line()
print(visitCountPlot)
```
```{r, echo = FALSE}
#create a data frame for visit per hour
hours <- vapply(split(1:nrow(visits),
format(as.POSIXlt(visits$Start),"%Y-%m-%d%H:00:00",tz='UTC')),
length,
0)
visitsPerHour <- as.numeric(hours)
hour <- as.POSIXct(names(hours))
visitCount <- data.frame(hour,visitsPerHour)
#Plot a line plot for the visitCount data frame
visitCountLine <- ggplot(visitCount, aes(hour, visitsPerHour)) +
geom_line() +
ylab("Count") +
xlab("") +
ggtitle("Visit count per hour")
```
This is the hour with the maximun number of visits
```{r, echo = FALSE}
print(visitCount$hour[which.max(visitCount$visitsPerHour)])
```
This is the nosepokes count with the appropriate plot
```{r, echo = FALSE}
#Plots nosepoke count per animal
nosepokesCountPlot <- ggplot(nosepokes, aes(AnimalName)) +
geom_bar() +
xlab("") +
ggtitle("Nosepokes Count")
print(table(nosepokes$AnimalName))
plot(nosepokesCountPlot)
```
Nosepokes over time for each animal
```{r, fig.width=10, fig.height=4, echo = FALSE}
#Plot Nosepokes over time using the ggplot2 package
nosepokePoints <- geom_point(aes(x = as.POSIXct(nosepokes$Start),
y = nosepokes$AnimalName,
colour = nosepokes$AnimalName),
alpha = 0.15)
nosepokesPointsPlot <- ggplot() +
nosepokePoints +
xlab("") +
ylab("") +
ggtitle("Nosepokes") +
theme(legend.title=element_blank())
plot(nosepokesPointsPlot)
```
Check that drinking occoured only in the 19:00 23:59 time window, it shows the nosepokes where atleast one lick had happend, horizontal lines show the time window were the corner is active.
```{r, echo = FALSE, fig.width=10, fig.height=4}
#Plot licks over time using the ggplot2 package
lickIdx <- (nosepokes$LickNumber > 0)
lickPoints <- geom_point(aes(x =as.POSIXct(nosepokes$Start[lickIdx]),
y = nosepokes$AnimalName[lickIdx],
colour = nosepokes$AnimalName[lickIdx]),
alpha = 0.3)
lickPointsPlot <- ggplot() +
lickPoints +
xlab("") +
ylab("") +
ggtitle("Nosepokes with at least one lick") +
theme(legend.title=element_blank())
plot(lickPointsPlot)
```
This is a plot showing the amount of nosepokes in the time window per day per animal
```{r, echo = FALSE}
#find all the nosepokes which occoured in the time windows
library(lubridate)
hourNosepokes <- hour(ymd_hms(as.POSIXct(nosepokes$Start)))
inds <- 1:max(which(hourNosepokes == 23)) #indices of nosepokes in days                                            #with window
hourNosepokes <- hourNosepokes[inds]
windowNosepokes <- nosepokes[inds,]
dayNosepokes <- day(ymd_hms(as.POSIXct(
windowNosepokes$Start)))
windowNosepokes$Day <- dayNosepokes
windowNosepokes$Hour <- hourNosepokes
startHour <- 19
endHour <- 23
windowNosepokes <- windowNosepokes[windowNosepokes$Hour >= startHour &
windowNosepokes$Hour <= endHour,]
p1 <- ggplot(windowNosepokes, aes(Day, fill=AnimalName)) +
geom_bar() +
ggtitle("Inside the time window nosepoke count")
```
This is the count of nosepokes per day per animal in the time windows
```{r, echo = FALSE}
#make a data frame with the count of nosepokes in the time window for each day for each animal
name <- rep(animals$AnimalName,
length(unique(windowNosepokes$Day)))
day <- rep(unique(windowNosepokes$Day),
length(animals$AnimalName))
animalWindowNosepokesCount <- data.frame(name, day, startHour, endHour)
names(animalWindowNosepokesCount) <- c("AnimalName", "Day", "startHour", "endHour")
#Set Start and End colums in data as postixct
windowNosepokes$Start <- as.POSIXct(windowNosepokes$Start)
windowNosepokes$End <- as.POSIXct(windowNosepokes$End)
rm(list = ls())
knit2html("TrainingLog20160401-2.Rmd")
knit2html("TrainingLog20160401.Rmd")
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
knit2html("TrainingLog20160401.Rmd-2")
knit2html("TrainingLog20160401-2.Rmd")
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
knit2html("TrainingLog20160401-2.Rmd")
source('~/Documents/IntelliProject/bindVisits.R')
sessionPath <- "Sessions/2016-04-04 11.11.49/"
visits2 <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
sessionPath <- "Sessions/2016-04-03 17.16.27/"
sessionPath2 <- "Sessions/2016-04-04 11.11.49/"
visits1 <- read.csv(paste0(sessionPath,"IntelliCage/Visits.txt"), sep = "\t")
vis <- bindVisits(visits1, visits2)
lapply(vis, class)
lapply(visits1, class)
lapply(visits2, class)
lapply(visits2, class) == lapply(visits1, class)
unlist(lapply(visits2, class)) == unlist(lapply(visits1, class))
unlist(lapply(vis, class)) == unlist(lapply(visits1, class))
View(vis)
source('~/Documents/IntelliProject/bindNosepokes.R')
nosepokes <- read.csv(paste0(sessionPath,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes1 <- read.csv(paste0(sessionPath,"IntelliCage/Nosepokes.txt"), sep = "\t")
nosepokes2 <- read.csv(paste0(sessionPath2,"IntelliCage/Nosepokes.txt"), sep = "\t")
View(nosepokes1)
View(nosepokes2)
View(nosepokes)
nos <- rbind(visits1, nosepokes1, nosepokes2)
nos <- bindNosepokes(visits1, nosepokes1, nosepokes2)
View(nos)
unlist(lapply(nos, class)) == unlist(lapply(nosepokes2, class))
knit2html("TrainingLog20160401-3.Rmd")
View(nosepokes1)
View(nosepokes2)
View(nosepokes)
rm(list = ls())
names(visitHourAnimal)
knit2html("TrainingLog20160401-3.Rmd")
visitHourAnimal
visitHourAnimal <- unlist(visitHourAnimal)
visitHourAnimal
rm(list = ls())
knit2html("TrainingLog20160401-3.Rmd")
visitHourAnimal
visitHourAnimalDF <- read.table(text = names(visitHourAnimal), sep = ".")
r?ead.table()
names(visitHourAnimal)
visitHourAnimal
visitHourAnimal[1]
visitHourAnimal[1,1]
visitHourAnimal[1,]
visitHourAnimal[,1]
visitHourAnimal[,2]
visitHourAnimal[1,]
visitHourAnimal[2,]
class(visitHourAnimal)
colnames(visitHourAnimal)
visitHourAnimalDF <- read.table(text = colnames(visitHourAnimal), sep = ".")
visitHourAnimalDF$VisitCount <- as.numeric(visitHourAnimal)
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
visitHourAnimal
animalDat
animalDat <- split(visits, visits$AnimalName)
head(animalDat)
class(animalDat)
class(visits$AnimalName)
rm(list = ls())
knit2html("TrainingLog20160401-3.Rmd")
class(animalDat)
animalDat
visitHourAnimal
dim(animalDat)
length(animalDat)
rm(list = ls())
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
class(visitHourAnimal1)
class(visitHourAnimal2)
length(visitHourAnimal1)
length(animalDat)
rm(list = ls())
knit2html("TrainingLog20160401-3.Rmd")
class(visitHourAnimal1)
class(visitHourAnimal2)
length(animalDat)
class(animalDat)
class(AnimalDat[1])
class(animalDat[1])
class(animalDat[[1])
class(animalDat[[1]])
class(animalDat[[2]])
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
class(animalDat[[1]])
class(animalDat[[2]])
rm(list = ls())
lapply(animalDat[[2]],class)
knit2html("TrainingLog20160401.Rmd")
a <- animalDat
knit2html("TrainingLog20160401-3.Rmd")
b <- animalDat
lapply(a, class)
lapply(b, class)
lapply(b[1], class)
lapply(b[[1]], class)
unlist(lapply(b[[1]], class)) == unlist(lapply(a[[1]], class))
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
rm(list = ls())
knit2html("TrainingLog20160401-3.Rmd")
visitHourAnimal2
visitHourAnimal1
1:nrow(animalDat)
nrow(animalDat)
knit2html("TrainingLog20160401.Rmd")
nrow(animalDat)
rm(list = ls())
knit2html("TrainingLog20160401.Rmd")
1:nrow(animalDat)
nrow(animalDat)
length(animalDat)
knit2html("TrainingLog20160401.Rmd")
knit2html("TrainingLog20160401.Rmd")
1:nrow(x)
1:nrow(animalDat[1])
1:nrow(animalDat[[1]])
str(animalDat)
rm(list = ls())
knit2html("TrainingLog20160401-03.Rmd")
knit2html("TrainingLog20160401-3.Rmd")
str(animalDat)
str(visitHourAnimal1)
knit2html("TrainingLog20160401-3.Rmd")
visitHourAnimal2
rm(list = ls())
knit2html("TrainingLog20160401-3.Rmd")
knit2html("TrainingLog20160401-3.Rmd")
knit2html("TrainingLog20160401-3.Rmd")
knit2html("TrainingLog20160401-3.Rmd")
a <- findTimeErrors(visits, windowNosepokes)
a
lengt(windowNosepokes)
nrow(windowNosepokes)
sum(a)
View(windowNosepokes)
nrow(animalWindowNosepokesCount)
animalWindowNosepokesCount
i <- 1
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]))
i <- 2
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]))
i <- 3
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]))
i <- 4
sum((windowNosepokes$AnimalName ==
animalWindowNosepokesCount$AnimalName[i]) &
(windowNosepokes$Day ==
animalWindowNosepokesCount$Day[i]) &
(windowNosepokes$Hour <=
animalWindowNosepokesCount$endHour[i]) &
(windowNosepokes$Hour >=
animalWindowNosepokesCount$startHour[i]))
animalWindowNosepokesCount
each animal
name <- rep(animals$AnimalName,
length(unique(windowNosepokes$Day)))
name <- rep(animals$AnimalName,
length(unique(windowNosepokes$Day)))
name
day <- rep(unique(windowNosepokes$Day),
length(animals$AnimalName))
day
seq_along(1:3)
seq_along(1:3,1:6)
seq_along(1)
seq_along(2:4)
?seq
seq(3,4,2)
seq(3,4,4)
seq(from = 3, to = 4, by = 4)
seq(from = 3, to = 4, by = 10)
rep(3,2)
rep(3:4,2)
?rep
rep.int(3:4,2)
repl_len(3:4,2)
rep_len(3:4,2)
rep_len(3:4,4)
rep(3:4, each = 2)
knit2html("TrainingLog20160401-3.Rmd")
knit2html("DelayCueAdaptLog20160403.Rmd")
rm(list = ls())
knit2html("DelayCueAdaptLog20160403.Rmd")
sum(lickIdx)
a <- nosepokes[lickIdx]
a <- nosepokes[lickIdx,1]
a <- nosepokes[lickIdx,]
View(a)
nrow(nosepokes)
b <- findTimeErrors(visits, windowNosepokes = nosepokes)
b <- findTimeErrors(visits, windowNosepokes = nosepokes)
visitStart <- visits$Start[visits$VisitID == x]
visitStart
noseStart
reactTime
reactTime <- noseStart - visitStart
reactTime
lickIdx <- (nosepokes$LickNumber > 0)
sum(lickIdx)
View(nosepokes1)
View(nosepokes)
View(nosepokes)
class(nosepokes$Start)
View(visits)
lickIdx2<- windowNosepokes$LickNumber > 0
sum(lickIdx2)
sum(findTimeErrors(visits, windowNosepokes))
sum(findTimeErrors(visits, windowNosepokes))
b <- findTimeErrors(visits, windowNosepokes)
b[1]
c <- windowNosepokes[b $ lickIdx2,]
c <- windowNosepokes[b & lickIdx2,]
c
View(c)
rm(list = ls())
rm(list = ls())
knit2html("DelayCueAdaptLog20160403.Rmd")
